import{_ as bt}from"./返回 (2)-4856710b.js";import{_ as Te,r as se,o as y,c as C,a as o,b as m,w as M,t as q,d as St,e as xt,f as Nt,g as _t,h as Et,i as E,j as Be,G as T,k as Ue,R as It,m as Lt,p as be,z as N,n as ne,P as le,F as Se,A as xe,M as Ne,u as _e}from"./index-cd00da37.js";import{a as te}from"./axios-b5ee139b.js";import{i as ae}from"./index-18acf776.js";const Mt={name:"StatisticsAnalysisHeader",props:{title:{type:String,default:"统计分析"}}},kt={class:"header"},$t={class:"header-content"},Rt={class:"logo-container"},At={class:"title"},Ot={class:"title-icons"};function Bt(F,a,ue,s,oe,k){const L=se("router-link");return y(),C("header",kt,[o("div",$t,[o("div",Rt,[m(L,{to:"/",class:"back-button",title:"返回主页"},{default:M(()=>a[0]||(a[0]=[o("img",{src:bt,alt:"返回",width:"32",height:"32"},null,-1)])),_:1,__:[0]})]),o("h1",At,q(ue.title),1),o("div",Ot,[m(L,{to:"/map-editor",class:"action-icon",title:"电子地图编辑"},{default:M(()=>a[1]||(a[1]=[o("img",{src:St,alt:"电子地图编辑",width:"32",height:"32"},null,-1)])),_:1,__:[1]}),m(L,{to:"/data-management",class:"action-icon",title:"数据管理"},{default:M(()=>a[2]||(a[2]=[o("img",{src:xt,alt:"数据管理",width:"32",height:"32"},null,-1)])),_:1,__:[2]}),m(L,{to:"/statistics-analysis",class:"action-icon",title:"统计分析"},{default:M(()=>a[3]||(a[3]=[o("img",{src:Nt,alt:"统计分析",width:"32",height:"32"},null,-1)])),_:1,__:[3]}),m(L,{to:"/prediction-simulation",class:"action-icon",title:"预警分析"},{default:M(()=>a[4]||(a[4]=[o("img",{src:_t,alt:"预警分析",width:"32",height:"32"},null,-1)])),_:1,__:[4]}),m(L,{to:"/water-pollution-simulation",class:"action-icon",title:"水污染扩散模拟"},{default:M(()=>a[5]||(a[5]=[o("img",{src:Et,alt:"水污染扩散模拟",width:"32",height:"32"},null,-1)])),_:1,__:[5]})])])])}const Vt=Te(Mt,[["render",Bt],["__scopeId","data-v-64adde60"]]);const Pt={name:"StatisticsAnalysis",components:{StatisticsAnalysisHeader:Vt},setup(){const F=E("waterStatistics"),a=E(""),ue=E(null),s=E([]),oe=E(new Set),k=E([]),L=E([]),D=E(new Set),O=E([]),B=E([]),H=E([]),j=E([]),w=E("waterLevel"),He=E(""),je=E(""),he=E("ammoniaNitrogen"),$=E([]),V=E(""),Ge=E(null),x=E([]),G=E([]),K=E(new Set),b=Be({ammoniaNitrogen:0,permanganateIndex:0,cod:0,flow:0,depth:0,totalNitrogen:0,totalPhosphorus:0}),_=Be({totalReservoirs:0,avgWaterLevel:0,totalStorage:0,avgInflow:0,avgOutflow:0,totalCapacity:0,floodLevel:0}),qe=Be({totalMonitorPoints:0,avgOxygen:0,avgCOD:0,avgTotalNitrogen:0}),Ee=E([]),fe=E([]),z=E([]),W=E([]);let R=null,A=null,Y=null,U=null,Q=null,X=null,Z=null,ee=null;const ie=e=>String(e).padStart(2,"0"),pe=e=>{const t=e.getFullYear(),n=ie(e.getMonth()+1),i=ie(e.getDate());return`${t}-${n}-${i}`},P=e=>{if(!e)return"";if(typeof e=="string"){const t=e.match(/(\d{4})[-\/.](\d{1,2})[-\/.](\d{1,2})/);if(t){const i=Number(t[1]),l=Number(t[2]),d=Number(t[3]);return`${i}-${ie(l)}-${ie(d)}`}const n=new Date(e);return isNaN(n)?"":pe(n)}return e instanceof Date?pe(e):""},Je=e=>{if(!(oe.value instanceof Set)||oe.value.size===0)return!1;const t=pe(e);return!oe.value.has(t)},Ke=e=>{if(!(D.value instanceof Set)||D.value.size===0)return!1;const t=pe(e);return!D.value.has(t)},Qe=e=>{if(!(K.value instanceof Set)||K.value.size===0)return!1;const t=J(e);return!K.value.has(t)},Xe=e=>{if(!(K.value instanceof Set)||K.value.size===0)return!1;const t=J(e);return!K.value.has(t)},we=async()=>{if(!a.value||!s.value||s.value.length!==2){_.avgWaterLevel=0,_.totalStorage=0,_.avgInflow=0,_.avgOutflow=0;return}try{const t=(await te.get("/api/waterSituation/list",{params:{page:1,pageSize:99999}})).data.list||[],[n,i]=s.value,l=t.filter(d=>{if(d.reservoirName!==a.value)return!1;const r=P(d.date),c=P(n),u=P(i);return r>=c&&r<=u});if(l.length>0){const d=l.map(h=>Number(h.waterLevel)||0).filter(h=>h>0),r=l.map(h=>Number(h.storage)||0).filter(h=>h>0),c=l.map(h=>Number(h.avgInflow)||0).filter(h=>h>0),u=l.map(h=>Number(h.avgOutflow)||0).filter(h=>h>0);_.avgWaterLevel=d.length>0?d.reduce((h,I)=>h+I,0)/d.length:0,_.totalStorage=r.length>0?Math.max(...r):0,_.avgInflow=c.length>0?c.reduce((h,I)=>h+I,0)/c.length:0,_.avgOutflow=u.length>0?u.reduce((h,I)=>h+I,0)/u.length:0;const g=l.map(h=>Number(h.totalCapacity)||0),f=l.map(h=>Number(h.floodLevel)||0);_.totalCapacity=g.length>0?Math.max(...g):0,_.floodLevel=f.length>0?Math.max(...f):0,console.log("总库容和汛限水位数据获取结果:",{selectedDataLength:l.length,capacityData:g,floodLevelData:f,totalCapacity:_.totalCapacity,floodLevel:_.floodLevel,sampleData:l.slice(0,3).map(h=>({reservoirName:h.reservoirName,totalCapacity:h.totalCapacity,floodLevel:h.floodLevel,rawTotalCapacity:h.totalCapacity,rawFloodLevel:h.floodLevel})),allCapacityValues:g,allFloodLevelValues:f}),await ve()}else _.avgWaterLevel=0,_.totalStorage=0,_.avgInflow=0,_.avgOutflow=0,_.totalCapacity=0,_.floodLevel=0,await ve();console.log("更新水情统计数据:",{selectedReservoir:a.value,selectedDateRange:s.value,foundData:l.length,stats:_})}catch(e){console.error("获取月度统计数据失败:",e),_.avgWaterLevel=0,_.totalStorage=0,_.avgInflow=0,_.avgOutflow=0,_.totalCapacity=0,_.floodLevel=0}},Ze=async()=>{console.log("手动触发查询:",{reservoir:a.value,dateRange:s.value,selectedCharts:B.value}),await we(),await ve()},Ve=(e,t)=>{console.log("清理被删除的图表实例:",{old:e,new:t});const n=e.filter(i=>!t.includes(i));console.log("被删除的图表:",n),n.forEach(i=>{switch(i){case"waterLevel":if(R)try{R.dispose(),R=null,console.log("已清理水位图表实例")}catch(l){console.warn("清理水位图表时出错:",l)}break;case"waterStorage":if(A)try{A.dispose(),A=null,console.log("已清理蓄水量图表实例")}catch(l){console.warn("清理蓄水量图表时出错:",l)}break;case"waterInflow":if(Y)try{Y.dispose(),Y=null,console.log("已清理入库流量图表实例")}catch(l){console.warn("清理入库流量图表时出错:",l)}break;case"waterOutflow":if(U)try{U.dispose(),U=null,console.log("已清理出库流量图表实例")}catch(l){console.warn("清理出库流量图表时出错:",l)}break}})},ve=async()=>{console.log("开始渲染选择的图表:",{selectedCharts:B.value,selectedReservoir:a.value,selectedDateRange:s.value,totalDataCount:z.value.length});let e=z.value;if(a.value&&(e=e.filter(t=>t.reservoirName===a.value),console.log("按水库过滤后数据:",e.length,"条")),s.value&&s.value.length===2){const[t,n]=s.value;e=e.filter(i=>{const l=P(i.date),d=P(t),r=P(n);return l>=d&&l<=r}),console.log("按日期范围过滤后数据:",e.length,"条")}console.log("最终过滤后的数据:",{count:e.length,sampleData:e.slice(0,3).map(t=>({reservoir:t.reservoirName,date:t.date,waterLevel:t.waterLevel,storage:t.storage,avgInflow:t.avgInflow,avgOutflow:t.avgOutflow}))}),await ne(),B.value.includes("waterLevel")&&(console.log("渲染水位分布图表，数据条数:",e.length),st(e)),B.value.includes("waterStorage")&&(console.log("渲染蓄水量变化图表，数据条数:",e.length),ht(e)),B.value.includes("waterInflow")&&(console.log("渲染入库流量图表，数据条数:",e.length),ft(e)),B.value.includes("waterOutflow")&&(console.log("渲染出库流量图表，数据条数:",e.length),pt(e))},et=async()=>{if(!a.value){oe.value=new Set;return}try{const i=((await te.get("/api/waterSituation/list",{params:{page:1,pageSize:99999}})).data.list||[]).filter(d=>d.reservoirName===a.value).map(d=>P(d.date)).filter(Boolean),l=new Set(i);if(oe.value=l,console.log("刷新水库可选日期:",{reservoir:a.value,availableDates:Array.from(l),currentSelectedDate:ue.value}),!s.value||s.value.length!==2){const d=Array.from(l).sort();d.length>=2?s.value=[d[d.length-2],d[d.length-1]]:d.length===1?s.value=[d[0],d[0]]:s.value=[]}await we()}catch(e){console.error("刷新水库可选日期失败:",e),oe.value=new Set}},tt=async()=>{if(!k.value||k.value.length===0){D.value=new Set;return}try{const t=(await te.get("/api/waterSituation/list",{params:{page:1,pageSize:99999}})).data.list||[],n=new Set;if(k.value.forEach(i=>{t.filter(r=>r.reservoirName===i).map(r=>P(r.date)).filter(Boolean).forEach(r=>n.add(r))}),D.value=n,console.log("刷新水情对比可选日期:",{reservoirs:k.value,availableDates:Array.from(n),currentSelectedDateRange:L.value}),!L.value||L.value.length!==2){const i=Array.from(n).sort();i.length>=2?L.value=[i[i.length-2],i[i.length-1]]:i.length===1?L.value=[i[0],i[0]]:L.value=[]}}catch(e){console.error("刷新水情对比可选日期失败:",e),D.value=new Set}},re=async()=>{try{console.log("开始获取水情统计数据...");const e=await te.get("/api/waterSituation/list",{params:{pageSize:99999}});if(e.data&&e.data.list){const t=e.data.list.map(l=>({...l,avgInflow:l.avgInflow!==null&&l.avgInflow!==void 0?Number(l.avgInflow):null,avgOutflow:l.avgOutflow!==null&&l.avgOutflow!==void 0?Number(l.avgOutflow):null,waterLevel:l.waterLevel!==null&&l.waterLevel!==void 0?Number(l.waterLevel):null,storage:l.storage!==null&&l.storage!==void 0?Number(l.storage):null,yoyIncrease:l.yoyIncrease!==null&&l.yoyIncrease!==void 0?Number(l.yoyIncrease):null,totalCapacity:l.totalCapacity!==null&&l.totalCapacity!==void 0?Number(l.totalCapacity):null,floodLevel:l.floodLevel!==null&&l.floodLevel!==void 0?Number(l.floodLevel):null}));z.value=t,console.log("获取到水情数据:",z.value.length,"条"),console.log("数据完整性检查:",{avgInflowValid:t.every(l=>l.avgInflow!==null&&!isNaN(l.avgInflow)),avgOutflowValid:t.every(l=>l.avgOutflow!==null&&!isNaN(l.avgOutflow)),totalCapacityValid:t.every(l=>l.totalCapacity!==null&&!isNaN(l.totalCapacity)),floodLevelValid:t.every(l=>l.floodLevel!==null&&!isNaN(l.floodLevel))});const n=t.slice(0,3);console.log("总库容和汛限水位数据样本:",n.map(l=>({reservoirName:l.reservoirName,totalCapacity:l.totalCapacity,floodLevel:l.floodLevel,date:l.date})));const i=[...new Set(z.value.map(l=>l.reservoirName))];if(Ee.value=i,console.log("提取到水库列表:",i.length,"个"),i.length>0&&!a.value&&(a.value=i[0],console.log("自动选择第一个水库:",a.value)),z.value.length>0&&(!s.value||s.value.length===0)){const l=[...new Set(z.value.map(d=>d.date))].sort();l.length>=2&&(s.value=[l[0],l[l.length-1]],console.log("自动设置日期范围:",s.value))}we(),console.log("水情数据获取完成，等待用户选择要显示的表格...")}}catch(e){console.error("获取水情统计数据失败:",e),le.error("获取水情统计数据失败，请检查后端服务是否正常")}},J=e=>{const t=e.getFullYear(),n=ie(e.getMonth()+1);return`${t}-${n}`},at=e=>e&&e.year!=null&&e.month!=null?`${e.year}-${ie(e.month)}`:"",ot=e=>{if(!(K.value instanceof Set)||K.value.size===0)return!1;const t=J(e);return!K.value.has(t)},ce=async()=>{if(console.log("开始更新环境统计数据:",{selectedMonitorPoint:V.value,selectedEnvDateRange:x.value,environmentDataListLength:W.value.length}),!V.value||!x.value||x.value.length!==2){console.warn("环境统计数据更新失败：缺少必要的选择参数"),b.ammoniaNitrogen=0,b.permanganateIndex=0,b.cod=0,b.flow=0,b.depth=0,b.totalNitrogen=0,b.totalPhosphorus=0;return}try{const t=(await te.get("/api/sectionMonitor/list",{params:{page:1,pageSize:1e4}})).data.list||[],[n,i]=x.value,l=t.filter(d=>{const r=`${d.year}-${String(d.month).padStart(2,"0")}`;return d.monitorPointName===V.value&&r>=n&&r<=i});if(console.log("环境统计数据过滤结果:",{totalData:t.length,selectedMonitorPoint:V.value,dateRange:[n,i],filteredData:l.length,sampleData:l.slice(0,3)}),l.length>0){const d=l.reduce((c,u)=>(c.ammoniaNitrogen+=Number(u.oxygen)||0,c.permanganateIndex+=Number(u.potassiumPermanganate)||0,c.cod+=Number(u.cod)||0,c.flow+=Number(u.flow)||0,c.depth+=Number(u.waterDepth)||0,c.totalNitrogen+=Number(u.totalNitrogen)||0,c.totalPhosphorus+=Number(u.totalPhosphorus)||0,c),{ammoniaNitrogen:0,permanganateIndex:0,cod:0,flow:0,depth:0,totalNitrogen:0,totalPhosphorus:0}),r=l.length;b.ammoniaNitrogen=d.ammoniaNitrogen/r,b.permanganateIndex=d.permanganateIndex/r,b.cod=d.cod/r,b.flow=d.flow/r,b.depth=d.depth/r,b.totalNitrogen=d.totalNitrogen/r,b.totalPhosphorus=d.totalPhosphorus/r}else b.ammoniaNitrogen=0,b.permanganateIndex=0,b.cod=0,b.flow=0,b.depth=0,b.totalNitrogen=0,b.totalPhosphorus=0}catch(e){console.error("获取环境统计数据失败:",e),b.ammoniaNitrogen=0,b.permanganateIndex=0,b.cod=0,b.flow=0,b.depth=0,b.totalNitrogen=0,b.totalPhosphorus=0}},de=async()=>{if(!(!$.value||$.value.length<2||!G.value||G.value.length!==2))try{const t=(await te.get("/api/sectionMonitor/list",{params:{page:1,pageSize:1e4}})).data.list||[],[n,i]=G.value,l=t.filter(d=>{const r=`${d.year}-${String(d.month).padStart(2,"0")}`;return $.value.includes(d.monitorPointName)&&r>=n&&r<=i});console.log("环境对比数据过滤结果:",{selectedPoints:$.value,dateRange:G.value,filteredDataCount:l.length})}catch(e){console.error("获取环境对比统计数据失败:",e)}},nt=()=>{if(!V.value){K.value=new Set;return}const e=W.value.filter(n=>n.monitorPointName===V.value).map(at).filter(Boolean),t=new Set(e);if(K.value=t,!x.value||x.value.length!==2)if(e.length>0){const i=Array.from(e).sort()[0],d=J(new Date);x.value=[i,d],console.log("使用监测点数据中的第一条记录设置月份范围:",x.value)}else{const n=new Date,i=new Date(n.getFullYear(),n.getMonth()-2,1);x.value=[J(i),J(n)]}},lt=async()=>{console.log("手动点击查询按钮，强制刷新环境统计数据和图表...");try{await ye(),await ce(),H.value.length>0&&(console.log("强制重新渲染选择的环境统计图表..."),await ge()),le.success("环境统计数据已刷新")}catch(e){console.error("刷新环境统计数据失败:",e),le.error("刷新环境统计数据失败，请重试")}},rt=(e,t=2)=>{const n=Number(e);return isNaN(n)?"0.00":n.toFixed(t)},ye=async()=>{try{if(F.value!=="environmentStatistics"&&F.value!=="environmentComparison"){console.log("环境面板未激活，跳过数据获取");return}console.log("开始获取环境统计数据...");const e=await te.get("/api/sectionMonitor/list",{params:{pageSize:99999}});if(e.data&&e.data.list){W.value=e.data.list,console.log("获取到环境数据:",W.value.length,"条");const t=[...new Set(W.value.map(n=>n.monitorPointName))];if(fe.value=t,console.log("提取到监测点列表:",t.length,"个"),t.length>0&&!V.value&&(V.value=t[0],console.log("自动选择第一个监测点:",V.value)),!x.value||x.value.length!==2)if(W.value.length>0){const n=W.value[0],i=`${n.year}-${String(n.month).padStart(2,"0")}`,d=J(new Date);x.value=[i,d],console.log("使用数据中的第一条记录设置月份范围:",x.value)}else{const n=new Date,i=new Date(n.getFullYear(),n.getMonth()-2,1);x.value=[J(i),J(n)],console.log("设置默认月份范围:",x.value)}await ce(),Oe()}}catch(e){console.error("获取环境统计数据失败:",e),le.error("获取环境统计数据失败，请检查后端服务是否正常")}},st=e=>{const t=document.getElementById("water-level-chart");if(!t){console.warn("水位分布图表容器不存在，跳过图表初始化");return}if(!document.contains(t)){console.warn("水位分布图表容器已从DOM中移除，跳过图表初始化");return}try{if(!R||!R.getDom||!R.getDom()||!document.contains(R.getDom())){if(R)try{R.dispose()}catch(r){console.warn("清理旧的水位图表实例时出错:",r)}R=ae(t),console.log("重新初始化水位图表实例")}if(!e||e.length===0){R.setOption({title:{text:Ie(),left:"center"},xAxis:{type:"category",data:[],axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"库水位"},series:[{name:"水位",type:"line",data:[],smooth:!0}],graphic:{type:"text",left:"center",top:"middle",style:{text:"暂无数据",fontSize:16,fill:"#999"}}});return}const n=e.sort((r,c)=>new Date(r.date)-new Date(c.date)),i=n.map(r=>{const c=new Date(r.date);return`${c.getMonth()+1}/${c.getDate()}`}),l=n.map(r=>Number(r.waterLevel)||0),d={title:{text:Ie(),left:"center"},tooltip:{trigger:"axis",formatter:function(r){const c=r[0].dataIndex;return`${n[c].date}<br/>水位: ${r[0].value} 米`}},xAxis:{type:"category",data:i,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"库水位"},series:[{name:"水位",type:"line",data:l,smooth:!0,lineStyle:{color:"#409EFF",width:3},itemStyle:{color:"#409EFF"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(64, 158, 255, 0.3)"},{offset:1,color:"rgba(64, 158, 255, 0.1)"}]}}}]};R.setOption(d,!0)}catch(n){if(console.error("初始化水位分布图表时出错:",n),R){try{R.dispose()}catch(i){console.warn("清理水位图表时出错:",i)}R=null}}},Ie=()=>{if(console.log("生成标题 - 当前状态:",{selectedReservoir:a.value,selectedDateRange:s.value,reservoirListLength:Ee.value.length}),!a.value)return console.log("标题: 水库水位分布"),"水库水位分布";if(!s.value||s.value.length!==2)return console.log("标题:",`${a.value}水位分布`),`${a.value}水位分布`;const[e,t]=s.value;if(!e||!t)return console.log("标题:",`${a.value}水位分布`),`${a.value}水位分布`;const n=r=>{if(!r)return"";const c=new Date(r);return isNaN(c.getTime())?r:`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`},i=n(e),l=n(t),d=`${a.value}水位分布（${i} 至 ${l}）`;return console.log("标题:",d),d},Le=()=>{if(!a.value)return"水库蓄水量变化";if(!s.value||s.value.length!==2)return`${a.value}蓄水量变化`;const[e,t]=s.value;if(!e||!t)return`${a.value}蓄水量变化`;const n=r=>{if(!r)return"";const c=new Date(r);return isNaN(c.getTime())?r:`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`},i=n(e),l=n(t);return`${a.value}蓄水量变化（${i} 至 ${l}）`},Me=()=>{if(!a.value)return"日均入库流量变化";if(!s.value||s.value.length!==2)return`${a.value}日均入库流量变化`;const[e,t]=s.value;if(!e||!t)return`${a.value}日均入库流量变化`;const n=r=>{if(!r)return"";const c=new Date(r);return isNaN(c.getTime())?r:`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`},i=n(e),l=n(t);return`${a.value}日均入库流量变化（${i} 至 ${l}）`},ke=()=>{if(!a.value)return"日均出库流量变化";if(!s.value||s.value.length!==2)return`${a.value}日均出库流量变化`;const[e,t]=s.value;if(!e||!t)return`${a.value}日均出库流量变化`;const n=r=>{if(!r)return"";const c=new Date(r);return isNaN(c.getTime())?r:`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`},i=n(e),l=n(t);return`${a.value}日均出库流量变化（${i} 至 ${l}）`},it=()=>{re()},ct=()=>{ye()},$e=async()=>{if(k.value.length>=2)try{console.log("开始获取水情对比数据:",{selectedReservoirs:k.value});const t=(await te.get("/api/waterSituation/list",{params:{page:1,pageSize:99999}})).data.list||[];console.log("获取到的原始水情数据:",{totalCount:t.length,sampleData:t.slice(0,3).map(d=>({reservoir:d.reservoirName,date:d.date,waterLevel:d.waterLevel,storage:d.storage,avgInflow:d.avgInflow,avgOutflow:d.avgOutflow}))});let n=t;if(L.value&&L.value.length===2){const[d,r]=L.value;n=t.filter(c=>{const u=P(c.date),g=P(d),f=P(r);return u>=g&&u<=f}),console.log("按日期范围过滤后的数据:",{originalCount:t.length,filteredCount:n.length,dateRange:L.value})}const l=k.value.map(d=>{const r=n.filter(c=>c.reservoirName===d);return console.log(`水库 ${d} 的数据:`,{count:r.length,sampleData:r.slice(0,2).map(c=>({date:c.date,waterLevel:c.waterLevel,storage:c.storage,avgInflow:c.avgInflow,avgOutflow:c.avgOutflow}))}),r.map(c=>({...c,reservoirName:d,date:c.date,waterLevel:c.waterLevel!==null&&c.waterLevel!==void 0?Number(c.waterLevel):null,storage:c.storage!==null&&c.storage!==void 0?Number(c.storage):null,avgInflow:c.avgInflow!==null&&c.avgInflow!==void 0?Number(c.avgInflow):null,avgOutflow:c.avgOutflow!==null&&c.avgOutflow!==void 0?Number(c.avgOutflow):null}))}).flat();console.log("对比数据准备完成:",{totalCount:l.length,reservoirs:k.value,indicator:w.value}),await Re(l)}catch(e){console.error("获取水情对比数据失败:",e),le.error("获取水情对比数据失败，请检查后端服务是否正常")}else le.warning("请至少选择两个水库，并选择对比指标")},dt=async()=>{if($.value.length>=2&&he.value)try{const t=(await te.get("/api/sectionMonitor/list",{params:{page:1,pageSize:1e4}})).data.list||[];let n=t;if(G.value&&G.value.length===2){const[l,d]=G.value;n=t.filter(r=>{const c=`${r.year}-${String(r.month).padStart(2,"0")}`;return c>=l&&c<=d}),console.log("环境对比数据按月份范围过滤:",{monthRange:G.value,originalCount:t.length,filteredCount:n.length})}const i=$.value.map(l=>n.filter(r=>r.monitorPointName===l).map(r=>({...r,monitorPointName:l,year:Number(r.year)||0,month:Number(r.month)||0,ammoniaNitrogen:Number(r.oxygen)||0,cod:Number(r.cod)||0,totalNitrogen:Number(r.totalNitrogen)||0,totalPhosphorus:Number(r.totalPhosphorus)||0,oxygen:Number(r.oxygen)||0,flow:Number(r.flow)||0,depth:Number(r.waterDepth)||0})));W.value=i.flat(),Oe()}catch(e){console.error("获取环境对比数据失败:",e),le.error("获取环境对比数据失败，请检查后端服务是否正常")}else le.warning("请至少选择两个监测点，并选择对比指标")},Re=async(e=null)=>{console.log("开始渲染选择的水情对比图表:",{selectedComparisonCharts:O.value,selectedReservoirs:k.value,selectedComparisonDateRange:L.value,totalDataCount:e?e.length:z.value.length});const t=e||z.value;if(!t||t.length===0){console.warn("没有数据可渲染");return}if(!k.value||k.value.length<2){console.warn("请至少选择两个水库");return}await ne(),O.value.includes("waterLevel")&&(console.log("渲染水库水位对比图表"),ut(t)),O.value.includes("storage")&&(console.log("渲染水库蓄水量对比图表"),vt(t)),O.value.includes("avgInflow")&&(console.log("渲染入库流量对比图表"),gt(t)),O.value.includes("avgOutflow")&&(console.log("渲染出库流量对比图表"),mt(t))},ut=e=>{const t=document.getElementById("water-level-comparison-chart");if(!t||!document.contains(t)){console.warn("水库水位对比图表容器不存在，跳过图表初始化");return}try{Q||(Q=ae(t));const n=k.value,i=n.map(u=>({name:u,data:e.filter(g=>g.reservoirName===u)})),l=[...new Set([].concat(...i.map(u=>u.data.map(g=>g.date))))].sort(),d=["#409EFF","#E6A23C","#67C23A","#F56C6C","#909399","#9C27B0","#00BCD4","#8D6E63","#EC407A","#26A69A"],r=i.map((u,g)=>({name:u.name,type:"line",data:l.map(f=>{const h=u.data.find(v=>P(v.date)===P(f)),I=h?h.waterLevel:null;return I!=null?Number(I):0}),itemStyle:{color:d[g%d.length]},lineStyle:{width:3},symbol:g%2===0?"circle":"diamond",symbolSize:6,smooth:!0})),c={title:{text:`${n.join("、")} - 库水位对比`,left:"center"},tooltip:{trigger:"axis",formatter:function(u){let g=u[0].axisValue+"<br/>";return u.forEach(f=>{g+=f.marker+f.seriesName+": "+f.value+" 米<br/>"}),g}},legend:{data:n,top:30},xAxis:{type:"category",data:l,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"库水位"},series:r};Q.setOption(c),console.log("水库水位对比图表渲染完成")}catch(n){if(console.error("初始化水库水位对比图表时出错:",n),Q){try{Q.dispose()}catch(i){console.warn("清理水库水位对比图表时出错:",i)}Q=null}}},vt=e=>{const t=document.getElementById("water-storage-comparison-chart");if(!t||!document.contains(t)){console.warn("水库蓄水量对比图表容器不存在，跳过图表初始化");return}try{X||(X=ae(t));const n=k.value,i=n.map(u=>({name:u,data:e.filter(g=>g.reservoirName===u)})),l=[...new Set([].concat(...i.map(u=>u.data.map(g=>g.date))))].sort(),d=["#409EFF","#E6A23C","#67C23A","#F56C6C","#909399","#9C27B0","#00BCD4","#8D6E63","#EC407A","#26A69A"],r=i.map((u,g)=>({name:u.name,type:"line",data:l.map(f=>{const h=u.data.find(v=>P(v.date)===P(f)),I=h?h.storage:null;return I!=null?Number(I):0}),itemStyle:{color:d[g%d.length]},lineStyle:{width:3},symbol:g%2===0?"circle":"diamond",symbolSize:6,smooth:!0})),c={title:{text:`${n.join("、")} - 蓄水量对比`,left:"center"},tooltip:{trigger:"axis",formatter:function(u){let g=u[0].axisValue+"<br/>";return u.forEach(f=>{g+=f.marker+f.seriesName+": "+f.value+" 万立方米<br/>"}),g}},legend:{data:n,top:30},xAxis:{type:"category",data:l,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"蓄水量(万立方米)"},series:r};X.setOption(c),console.log("水库蓄水量对比图表渲染完成")}catch(n){if(console.error("初始化水库蓄水量对比图表时出错:",n),X){try{X.dispose()}catch(i){console.warn("清理水库蓄水量对比图表时出错:",i)}X=null}}},gt=e=>{const t=document.getElementById("water-inflow-comparison-chart");if(!t||!document.contains(t)){console.warn("入库流量对比图表容器不存在，跳过图表初始化");return}try{Z||(Z=ae(t));const n=k.value,i=n.map(u=>({name:u,data:e.filter(g=>g.reservoirName===u)})),l=[...new Set([].concat(...i.map(u=>u.data.map(g=>g.date))))].sort(),d=["#409EFF","#E6A23C","#67C23A","#F56C6C","#909399","#9C27B0","#00BCD4","#8D6E63","#EC407A","#26A69A"],r=i.map((u,g)=>({name:u.name,type:"line",data:l.map(f=>{const h=u.data.find(v=>P(v.date)===P(f)),I=h?h.avgInflow:null;return I!=null?Number(I):0}),itemStyle:{color:d[g%d.length]},lineStyle:{width:3},symbol:g%2===0?"circle":"diamond",symbolSize:6,smooth:!0})),c={title:{text:`${n.join("、")} - 入库流量对比`,left:"center"},tooltip:{trigger:"axis",formatter:function(u){let g=u[0].axisValue+"<br/>";return u.forEach(f=>{g+=f.marker+f.seriesName+": "+f.value+" 立方米/秒<br/>"}),g}},legend:{data:n,top:30},xAxis:{type:"category",data:l,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"入库流量(立方米/秒)"},series:r};Z.setOption(c),console.log("入库流量对比图表渲染完成")}catch(n){if(console.error("初始化入库流量对比图表时出错:",n),Z){try{Z.dispose()}catch(i){console.warn("清理入库流量对比图表时出错:",i)}Z=null}}},mt=e=>{const t=document.getElementById("water-outflow-comparison-chart");if(!t||!document.contains(t)){console.warn("出库流量对比图表容器不存在，跳过图表初始化");return}try{ee||(ee=ae(t));const n=k.value,i=n.map(u=>({name:u,data:e.filter(g=>g.reservoirName===u)})),l=[...new Set([].concat(...i.map(u=>u.data.map(g=>g.date))))].sort(),d=["#409EFF","#E6A23C","#67C23A","#F56C6C","#909399","#9C27B0","#00BCD4","#8D6E63","#EC407A","#26A69A"],r=i.map((u,g)=>({name:u.name,type:"line",data:l.map(f=>{const h=u.data.find(v=>P(v.date)===P(f)),I=h?h.avgOutflow:null;return I!=null?Number(I):0}),itemStyle:{color:d[g%d.length]},lineStyle:{width:3},symbol:g%2===0?"circle":"diamond",symbolSize:6,smooth:!0})),c={title:{text:`${n.join("、")} - 出库流量对比`,left:"center"},tooltip:{trigger:"axis",formatter:function(u){let g=u[0].axisValue+"<br/>";return u.forEach(f=>{g+=f.marker+f.seriesName+": "+f.value+" 立方米/秒<br/>"}),g}},legend:{data:n,top:30},xAxis:{type:"category",data:l,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"出库流量(立方米/秒)"},series:r};ee.setOption(c),console.log("出库流量对比图表渲染完成")}catch(n){if(console.error("初始化出库流量对比图表时出错:",n),ee){try{ee.dispose()}catch(i){console.warn("清理出库流量对比图表时出错:",i)}ee=null}}},ht=e=>{const t=document.getElementById("water-storage-chart");if(!t){console.warn("蓄水量图表容器不存在，跳过图表初始化");return}if(!document.contains(t)){console.warn("蓄水量图表容器已从DOM中移除，跳过图表初始化");return}try{if(!A||!A.getDom||!A.getDom()||!document.contains(A.getDom())){if(A)try{A.dispose()}catch(r){console.warn("清理旧的蓄水量图表实例时出错:",r)}A=ae(t),console.log("重新初始化蓄水量图表实例")}if(!e||e.length===0){A.setOption({title:{text:Le(),left:"center"},graphic:{type:"text",left:"center",top:"middle",style:{text:"暂无数据",fontSize:16,fill:"#999"}}});return}const n=e.sort((r,c)=>new Date(r.date)-new Date(c.date)),i=n.map(r=>{const c=new Date(r.date);return`${c.getMonth()+1}/${c.getDate()}`}),l=n.map(r=>Number(r.storage)||0),d={title:{text:Le(),left:"center"},tooltip:{trigger:"axis",formatter:function(r){const c=r[0].dataIndex;return`${n[c].date}<br/>蓄水量: ${r[0].value} 万立方米`}},xAxis:{type:"category",data:i,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"蓄水量(万立方米)",nameLocation:"middle",nameGap:40},series:[{name:"蓄水量",type:"line",data:l,smooth:!0,lineStyle:{color:"#67C23A",width:3},itemStyle:{color:"#67C23A"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(103, 194, 58, 0.3)"},{offset:1,color:"rgba(103, 194, 58, 0.1)"}]}}}]};A.setOption(d,!0)}catch(n){if(console.error("初始化蓄水量图表时出错:",n),A){try{A.dispose()}catch(i){console.warn("清理蓄水量图表时出错:",i)}A=null}}},ft=e=>{const t=document.getElementById("water-inflow-chart");if(!t){console.warn("入库流量图表容器不存在，跳过图表初始化");return}if(!document.contains(t)){console.warn("入库流量图表容器已从DOM中移除，跳过图表初始化");return}try{if(Y||(Y=ae(t)),!e||e.length===0){Y.setOption({title:{text:Me(),left:"center"},graphic:{type:"text",left:"center",top:"middle",style:{text:"暂无数据",fontSize:16,fill:"#999"}}});return}const n=e.sort((r,c)=>new Date(r.date)-new Date(c.date)),i=n.map(r=>{const c=new Date(r.date);return`${c.getMonth()+1}/${c.getDate()}`}),l=n.map(r=>Number(r.avgInflow)||0),d={title:{text:Me(),left:"center"},tooltip:{trigger:"axis",formatter:function(r){const c=r[0].dataIndex;return`${n[c].date}<br/>日均入库流量: ${r[0].value} 立方米/秒`}},xAxis:{type:"category",data:i,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"日均入库流量(立方米/秒)",nameLocation:"middle",nameGap:40},series:[{name:"日均入库流量",type:"line",data:l,smooth:!0,lineStyle:{color:"#E6A23C",width:3},itemStyle:{color:"#E6A23C"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(230, 162, 60, 0.3)"},{offset:1,color:"rgba(230, 162, 60, 0.1)"}]}}}]};Y.setOption(d,!0)}catch(n){if(console.error("初始化入库流量图表时出错:",n),Y){try{Y.dispose()}catch(i){console.warn("清理入库流量图表时出错:",i)}Y=null}}},pt=e=>{const t=document.getElementById("water-outflow-chart");if(!t){console.warn("出库流量图表容器不存在，跳过图表初始化");return}if(!document.contains(t)){console.warn("出库流量图表容器已从DOM中移除，跳过图表初始化");return}try{if(U||(U=ae(t)),!e||e.length===0){U.setOption({title:{text:ke(),left:"center"},graphic:{type:"text",left:"center",top:"middle",style:{text:"暂无数据",fontSize:16,fill:"#999"}}});return}const n=e.sort((r,c)=>new Date(r.date)-new Date(c.date)),i=n.map(r=>{const c=new Date(r.date);return`${c.getMonth()+1}/${c.getDate()}`}),l=n.map(r=>Number(r.avgOutflow)||0),d={title:{text:ke(),left:"center"},tooltip:{trigger:"axis",formatter:function(r){const c=r[0].dataIndex;return`${n[c].date}<br/>日均出库流量: ${r[0].value} 立方米/秒`}},xAxis:{type:"category",data:i,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"日均出库流量(立方米/秒)",nameLocation:"middle",nameGap:40},series:[{name:"日均出库流量",type:"line",data:l,smooth:!0,lineStyle:{color:"#F56C6C",width:3},itemStyle:{color:"#F56C6C"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(245, 108, 108, 0.3)"},{offset:1,color:"rgba(245, 108, 108, 0.1)"}]}}}]};U.setOption(d,!0)}catch(n){if(console.error("初始化出库流量图表时出错:",n),U){try{U.dispose()}catch(i){console.warn("清理出库流量图表时出错:",i)}U=null}}};T(F,async e=>{if(console.log("面板切换到:",e),e==="environmentStatistics")if(console.log("切换到环境统计面板，清空表格选择，等待用户重新选择..."),H.value=[],W.value.length===0)console.log("切换到环境面板，开始获取环境数据..."),await ye();else{if(console.log("环境数据已存在，确保监测点和日期范围已设置..."),!V.value&&fe.value.length>0&&(V.value=fe.value[0],console.log("自动选择第一个监测点:",V.value)),!x.value||x.value.length!==2)if(W.value.length>0){const t=W.value[0],n=`${t.year}-${String(t.month).padStart(2,"0")}`,l=J(new Date);x.value=[n,l],console.log("使用数据中的第一条记录设置月份范围:",x.value)}else{const t=new Date,n=new Date(t.getFullYear(),t.getMonth()-2,1);x.value=[J(n),J(t)],console.log("设置默认月份范围:",x.value)}await ce()}else e==="environmentComparison"?(console.log("切换到环境对比面板，清空表格选择，等待用户重新选择..."),j.value=[],W.value.length===0?(console.log("切换到环境对比面板，开始获取环境数据..."),await ye()):(console.log("环境数据已存在，确保环境对比参数已设置..."),console.log("环境对比面板等待用户手动选择日期范围..."),await de())):e==="waterComparison"?(console.log("切换到水情对比面板，清空表格选择，等待用户重新选择..."),O.value=[],z.value.length===0?(console.log("切换到水情对比面板，开始获取水情数据..."),await re()):console.log("水情数据已存在，但表格选择已清空，等待用户重新选择...")):e==="waterStatistics"&&(console.log("切换到水情统计面板，清空表格选择，等待用户重新选择..."),B.value=[],z.value.length===0?(console.log("水情数据为空，重新获取数据..."),await re()):(console.log("水情数据已存在，检查数据完整性..."),z.value.every(n=>n.avgInflow!==null&&n.avgInflow!==void 0&&!isNaN(Number(n.avgInflow))&&n.avgOutflow!==null&&n.avgOutflow!==void 0&&!isNaN(Number(n.avgOutflow)))?console.log("数据完整，但表格选择已清空，等待用户重新选择..."):(console.log("检测到数据不完整，重新获取数据..."),await re())))});let Ae;Ue(()=>{Ae=setInterval(()=>{F.value==="waterStatistics"&&z.value.length>0&&(z.value.every(t=>t.avgInflow!==null&&t.avgInflow!==void 0&&!isNaN(Number(t.avgInflow))&&t.avgOutflow!==null&&t.avgOutflow!==void 0&&!isNaN(Number(t.avgOutflow)))||(console.log("定期检查发现数据不完整，自动恢复..."),re()))},3e4)}),It(()=>{Ae&&clearInterval(Ae)}),T(B,async(e,t)=>{console.log("水情统计表格选择变化:",{old:t,new:e}),F.value==="waterStatistics"&&z.value.length>0&&(e.length===0?(console.log("用户清空了所有表格选择，清理图表实例"),Ve(t,[])):(console.log("用户选择了表格，开始渲染图表..."),Ve(t,e),await ne(),await wt(),await ve()))}),T(O,async(e,t)=>{console.log("水情对比表格选择变化:",{old:t,new:e}),F.value==="waterComparison"&&z.value.length>0&&(e.length===0?(console.log("用户清空了所有对比表格选择，清理图表实例"),cleanupRemovedComparisonCharts(t,[])):(console.log("用户选择了对比表格，开始渲染图表..."),cleanupRemovedComparisonCharts(t,e),await ne(),await Re()))}),T(H,async(e,t)=>{console.log("环境统计表格选择变化:",{old:t,new:e}),F.value==="environmentStatistics"&&(e.length===0?(console.log("用户清空了所有环境统计表格选择，清理图表实例"),Pe(t,[])):(console.log("用户选择了环境统计表格，自动更新数据并渲染图表..."),Pe(t,e),await ce(),await ne(),await ge()))}),T(j,async(e,t)=>{console.log("环境对比表格选择变化:",{old:t,new:e}),F.value==="environmentComparison"&&W.value.length>0&&(e.length===0?(console.log("用户清空了所有环境对比表格选择，清理图表实例"),Fe(t,[])):(console.log("用户选择了环境对比表格，自动更新数据并渲染图表..."),Fe(t,e),await de(),await ne(),await me()))}),T(a,async(e,t)=>{console.log("水库选择变化:",{old:t,new:e}),await et()}),T(s,async(e,t)=>{console.log("日期范围选择变化:",{old:t,new:e}),await we()}),T(k,async(e,t)=>{console.log("水情对比水库选择变化:",{old:t,new:e}),await tt()}),T(L,async(e,t)=>{console.log("水情对比日期范围选择变化:",{old:t,new:e}),F.value==="waterComparison"&&k.value.length>=2&&await $e()}),T(O,async(e,t)=>{console.log("水情对比表格选择变化:",{old:t,new:e}),F.value==="waterComparison"&&k.value.length>=2&&await $e()}),T(V,async()=>{console.log("监测点选择变化，自动更新数据和图表..."),nt(),await ce(),F.value==="environmentStatistics"&&H.value.length>0&&(console.log("监测点变化，重新渲染环境统计图表..."),await ge())}),T(x,async()=>{console.log("环境统计日期范围变化，自动更新数据和图表..."),await ce(),F.value==="environmentStatistics"&&H.value.length>0&&(console.log("日期范围变化，重新渲染环境统计图表..."),await ge())}),T(G,async()=>{console.log("环境对比日期范围变化，自动更新数据..."),await de(),F.value==="environmentComparison"&&j.value.length>0&&(console.log("日期范围变化，重新渲染环境对比图表..."),await me())}),T($,async()=>{console.log("环境对比监测点选择变化，自动更新数据..."),await de(),F.value==="environmentComparison"&&j.value.length>0&&(console.log("监测点变化，重新渲染环境对比图表..."),await me())}),T(he,async()=>{console.log("环境对比指标选择变化，自动更新数据..."),await de(),F.value==="environmentComparison"&&j.value.length>0&&(console.log("对比指标变化，重新渲染环境对比图表..."),await me())}),Ue(async()=>{try{B.value=[],O.value=[],H.value=[],j.value=[],console.log("组件挂载完成，所有面板初始状态下无表格选择，等待用户选择..."),re(),console.log("环境统计数据将在用户切换到环境面板时获取")}catch(e){console.error("组件挂载时出错:",e),re()}});const wt=async()=>{let n=0;for(;n<50;){const i={};if(B.value.includes("waterLevel")&&(i.waterLevel=document.getElementById("water-level-chart")),B.value.includes("waterStorage")&&(i.waterStorage=document.getElementById("water-storage-chart")),B.value.includes("waterInflow")&&(i.waterInflow=document.getElementById("water-inflow-chart")),B.value.includes("waterOutflow")&&(i.waterOutflow=document.getElementById("water-outflow-chart")),Object.values(i).every(d=>d!==null))return console.log("选择的图表容器已准备好:",Object.keys(i)),!0;console.log(`等待图表容器准备... 尝试 ${n+1}/50`),console.log("容器状态:",i),await new Promise(d=>setTimeout(d,50)),n++}return console.warn("等待图表容器超时，强制初始化"),!1},Pe=(e,t)=>{console.log("清理被删除的环境统计图表实例:",{old:e,new:t});const n=e.filter(i=>!t.includes(i));console.log("被删除的环境统计图表:",n),n.forEach(i=>{const l=ze(i),d=document.getElementById(l);d&&(d.innerHTML="",console.log(`已清理环境统计图表容器: ${l}`))})},Fe=(e,t)=>{console.log("清理被删除的环境对比图表实例:",{old:e,new:t});const n=e.filter(i=>!t.includes(i));console.log("被删除的环境对比图表:",n),n.forEach(i=>{const l=We(i),d=document.getElementById(l);d&&(d.innerHTML="",console.log(`已清理环境对比图表容器: ${l}`))})},ze=e=>({ammoniaNitrogen:"ammonia-nitrogen-chart",permanganateIndex:"permanganate-index-chart",cod:"cod-chart",flow:"flow-chart",depth:"depth-chart",totalNitrogen:"total-nitrogen-chart",totalPhosphorus:"total-phosphorus-chart"})[e]||e,We=e=>({ammoniaNitrogen:"environment-ammonia-nitrogen-chart",permanganateIndex:"environment-permanganate-index-chart",cod:"environment-cod-chart",flow:"environment-flow-chart",depth:"environment-depth-chart",totalNitrogen:"environment-total-nitrogen-chart",totalPhosphorus:"environment-total-phosphorus-chart"})[e]||e,ge=async()=>{console.log("开始渲染选择的环境统计图表:",{selectedCharts:H.value,selectedMonitorPoint:V.value,selectedEnvDateRange:x.value,totalDataCount:W.value.length}),await ne();for(const e of H.value){const t=ze(e);document.getElementById(t)?(console.log(`渲染环境统计图表: ${e}, 容器ID: ${t}`),await Ct(e,t)):console.warn(`环境统计图表容器未找到: ${t}`)}},me=async()=>{console.log("开始渲染选择的环境对比图表:",{selectedCharts:j.value,selectedMonitorPoints:$.value,selectedEnvComparisonDateRange:G.value,comparisonEnvironmentIndicator:he.value,totalDataCount:W.value.length}),await ne();for(const e of j.value){const t=We(e);document.getElementById(t)?(console.log(`渲染环境对比图表: ${e}, 容器ID: ${t}`),await Oe(e,t)):console.warn(`环境对比图表容器未找到: ${t}`)}},Ce=e=>({ammoniaNitrogen:"氨氮指标分布",permanganateIndex:"高锰酸盐指标分布",cod:"化学需氧量指标分布",flow:"流量指标分布",depth:"水深指标分布",totalNitrogen:"总氮指标分布",totalPhosphorus:"总磷指标分布"})[e]||e,De=e=>({ammoniaNitrogen:"氨氮指标对比分析",permanganateIndex:"高锰酸盐指标对比分析",cod:"化学需氧量指标对比分析",flow:"流量指标对比分析",depth:"水深指标对比分析",totalNitrogen:"总氮指标对比分析",totalPhosphorus:"总磷指标对比分析"})[e]||e,Oe=async(e,t)=>{try{if(!$.value||$.value.length<2||!G.value||G.value.length!==2){console.warn("环境对比图表渲染失败：缺少必要的选择参数");return}const i=(await te.get("/api/sectionMonitor/list",{params:{page:1,pageSize:1e4}})).data.list||[],[l,d]=G.value,r=i.filter(v=>{const S=`${v.year}-${String(v.month).padStart(2,"0")}`;return S>=l&&S<=d});if(console.log("环境对比图表数据过滤结果:",{totalData:i.length,selectedMonitorPoints:$.value,dateRange:[l,d],filteredData:r.length,sampleData:r.slice(0,3)}),r.length===0){console.warn("环境对比图表渲染失败：没有找到符合条件的数据");return}console.log(`渲染${De(e)}对比图表，数据条数: ${r.length}`);let c=[],u="",g="";switch(e){case"ammoniaNitrogen":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.oxygen)||0}))}}),u="氨氮含量",g="mg/L";break;case"permanganateIndex":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.potassiumPermanganate)||0}))}}),u="高锰酸盐指数",g="mg/L";break;case"cod":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.cod)||0}))}}),u="化学需氧量",g="mg/L";break;case"flow":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.flow)||0}))}}),u="流量",g="m³/s";break;case"depth":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.waterDepth)||0}))}}),u="水深",g="m";break;case"totalNitrogen":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.totalNitrogen)||0}))}}),u="总氮",g="mg/L";break;case"totalPhosphorus":c=$.value.map(v=>{const S=r.filter(p=>p.monitorPointName===v);return{name:v,data:S.map(p=>({date:`${p.year}-${String(p.month).padStart(2,"0")}`,value:Number(p.totalPhosphorus)||0}))}}),u="总磷",g="mg/L";break;default:console.warn(`未知的环境对比图表类型: ${e}`);return}const f=[...new Set(r.map(v=>`${v.year}-${String(v.month).padStart(2,"0")}`))];f.sort();const h=ae(document.getElementById(t)),I={title:{text:`${De(e)}（${l} 至 ${d}）`,left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",formatter:function(v){let S=`${v[0].name}<br/>`;return v.forEach(p=>{S+=`${p.seriesName}: ${p.value} ${g}<br/>`}),S}},legend:{data:$.value,top:"10%"},xAxis:{type:"category",data:f,axisLabel:{rotate:45}},yAxis:{type:"value",name:u,nameLocation:"middle",nameGap:50,axisLabel:{formatter:`{value} ${g}`}},series:c.map((v,S)=>({name:v.name,type:"line",data:f.map(p=>{const Ye=v.data.find(Dt=>Dt.date===p);return Ye?Ye.value:0}),smooth:!0,lineStyle:{width:3},itemStyle:{color:yt(S)}})),grid:{left:"10%",right:"10%",bottom:"15%",top:"20%"}};h.setOption(I),console.log(`${De(e)}对比图表渲染完成`)}catch(n){console.error(`渲染环境对比图表失败: ${e}`,n);const i=document.getElementById(t);i&&(i.innerHTML=`
            <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #f56c6c;">
              <div style="text-align: center;">
                <h4>${De(e)}</h4>
                <p>图表渲染失败，请重试</p>
                <p style="font-size: 12px; color: #999;">${n.message}</p>
              </div>
            </div>
          `)}},yt=e=>{const t=["#E74C3C","#9B59B6","#F39C12","#3498DB","#1ABC9C","#2ECC71","#E67E22","#95A5A6"];return t[e%t.length]},Ct=async(e,t)=>{try{if(!V.value||!x.value||x.value.length!==2){console.warn("环境统计图表渲染失败：缺少必要的选择参数");return}const i=(await te.get("/api/sectionMonitor/list",{params:{page:1,pageSize:1e4}})).data.list||[],[l,d]=x.value,r=i.filter(v=>{const S=`${v.year}-${String(v.month).padStart(2,"0")}`;return v.monitorPointName===V.value&&S>=l&&S<=d});if(console.log("环境统计图表数据过滤结果:",{totalData:i.length,selectedMonitorPoint:V.value,dateRange:[l,d],filteredData:r.length,sampleData:r.slice(0,3)}),r.length===0){console.warn("环境统计图表渲染失败：没有找到符合条件的数据");return}console.log(`渲染${Ce(e)}图表，数据条数: ${r.length}`);let c=[],u="",g="",f={};switch(e){case"ammoniaNitrogen":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.oxygen)||0})),u="氨氮含量",g="mg/L",f={lineColor:"#E74C3C",areaStartColor:"rgba(231, 76, 60, 0.4)",areaEndColor:"rgba(231, 76, 60, 0.1)"};break;case"permanganateIndex":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.potassiumPermanganate)||0})),u="高锰酸盐指数",g="mg/L",f={lineColor:"#9B59B6",areaStartColor:"rgba(155, 89, 182, 0.4)",areaEndColor:"rgba(155, 89, 182, 0.1)"};break;case"cod":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.cod)||0})),u="化学需氧量",g="mg/L",f={lineColor:"#F39C12",areaStartColor:"rgba(243, 156, 18, 0.4)",areaEndColor:"rgba(243, 156, 18, 0.1)"};break;case"flow":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.flow)||0})),u="流量",g="m³/s",f={lineColor:"#3498DB",areaStartColor:"rgba(52, 152, 219, 0.4)",areaEndColor:"rgba(52, 152, 219, 0.1)"};break;case"depth":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.waterDepth)||0})),u="水深",g="m",f={lineColor:"#1ABC9C",areaStartColor:"rgba(26, 188, 156, 0.4)",areaEndColor:"rgba(26, 188, 156, 0.1)"};break;case"totalNitrogen":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.totalNitrogen)||0})),u="总氮",g="mg/L",f={lineColor:"#2ECC71",areaStartColor:"rgba(46, 204, 113, 0.4)",areaEndColor:"rgba(46, 204, 113, 0.1)"};break;case"totalPhosphorus":c=r.map(v=>({date:`${v.year}-${String(v.month).padStart(2,"0")}`,value:Number(v.totalPhosphorus)||0})),u="总磷",g="mg/L",f={lineColor:"#E67E22",areaStartColor:"rgba(230, 126, 34, 0.4)",areaEndColor:"rgba(230, 126, 34, 0.1)"};break;default:console.warn(`未知的环境统计图表类型: ${e}`);return}c.sort((v,S)=>v.date.localeCompare(S.date));const h=ae(document.getElementById(t)),I={title:{text:`${V.value}${Ce(e)}（${l} 至 ${d}）`,left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",formatter:function(v){const S=v[0];return`${S.name}<br/>${u}: ${S.value} ${g}`}},xAxis:{type:"category",data:c.map(v=>v.date),axisLabel:{rotate:45}},yAxis:{type:"value",name:u,nameLocation:"middle",nameGap:50,axisLabel:{formatter:`{value} ${g}`}},series:[{name:u,type:"line",data:c.map(v=>v.value),smooth:!0,lineStyle:{width:3,color:f.lineColor},itemStyle:{color:f.lineColor},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:f.areaStartColor},{offset:1,color:f.areaEndColor}]}}}],grid:{left:"10%",right:"10%",bottom:"15%",top:"15%"}};h.setOption(I),console.log(`${Ce(e)}图表渲染完成`)}catch(n){console.error(`渲染环境统计图表失败: ${e}`,n);const i=document.getElementById(t);i&&(i.innerHTML=`
            <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #f56c6c;">
              <div style="text-align: center;">
                <h4>${Ce(e)}</h4>
                <p>图表渲染失败，请重试</p>
                <p style="font-size: 12px; color: #999;">${n.message}</p>
              </div>
            </div>
          `)}};return Lt(()=>{if(console.log("组件卸载，清理图表实例"),R){try{R.getDom&&R.getDom()&&R.dispose()}catch(e){console.warn("清理水位图表时出错:",e)}R=null}if(A){try{A.getDom&&A.getDom()&&A.dispose()}catch(e){console.warn("清理蓄水量图表时出错:",e)}A=null}if(Y){try{Y.getDom&&Y.getDom()&&Y.dispose()}catch(e){console.warn("清理入库流量图表时出错:",e)}Y=null}if(U){try{U.getDom&&U.getDom()&&U.dispose()}catch(e){console.warn("清理出库流量图表时出错:",e)}U=null}if(Q){try{Q.getDom&&Q.getDom()&&Q.dispose()}catch(e){console.warn("清理水库水位对比图表时出错:",e)}Q=null}if(X){try{X.getDom&&X.getDom()&&X.dispose()}catch(e){console.warn("清理水库蓄水量对比图表时出错:",e)}X=null}if(Z){try{Z.getDom&&Z.getDom()&&Z.dispose()}catch(e){console.warn("清理入库流量对比图表时出错:",e)}Z=null}if(ee){try{ee.getDom&&ee.getDom()&&ee.dispose()}catch(e){console.warn("清理出库流量对比图表时出错:",e)}ee=null}console.log("图表实例清理完成，数据保持持久化")}),{activeBox:F,selectedReservoir:a,selectedDate:ue,selectedDateRange:s,selectedReservoirs:k,selectedComparisonDateRange:L,selectedComparisonCharts:O,selectedCharts:B,selectedEnvironmentCharts:H,selectedEnvironmentComparisonCharts:j,comparisonMonitorPoint1:He,comparisonMonitorPoint2:je,comparisonEnvironmentIndicator:he,selectedMonitorPoints:$,waterStats:_,environmentStats:qe,reservoirList:Ee,monitorPointList:fe,disableUnavailableDates:Je,disableUnavailableComparisonDates:Ke,applySelectedWaterStats:Ze,renderSelectedCharts:ve,renderSelectedComparisonCharts:Re,renderSelectedEnvironmentCharts:ge,renderSelectedEnvironmentComparisonCharts:me,refreshWaterData:it,refreshEnvironmentData:ct,refreshComparisonData:$e,refreshEnvironmentComparison:dt,selectedMonitorPoint:V,selectedEnvMonth:Ge,selectedEnvDateRange:x,selectedEnvComparisonDateRange:G,disableUnavailableEnvMonths:ot,disableUnavailableEnvDates:Qe,disableUnavailableEnvComparisonDates:Xe,applySelectedEnvironmentStats:lt,updateSelectedEnvironmentComparisonStats:de,envDisplayStats:b,formatNumber:rt,getWaterLevelChartTitle:Ie,getWaterStorageChartTitle:Le,getWaterInflowChartTitle:Me,getWaterOutflowChartTitle:ke}}},Ft={class:"statistics-analysis-container"},zt={class:"statistics-analysis-main"},Wt={class:"statistics-sidebar"},Yt={class:"statistics-content"},Ut={key:0,class:"water-statistics-panel"},Tt={class:"panel-header"},Ht={class:"header-actions"},jt={class:"water-statistics-cards"},Gt={class:"water-stat-circle"},qt={class:"stat-circle-bg"},Jt={class:"stat-circle-value"},Kt={class:"water-stat-circle"},Qt={class:"stat-circle-bg"},Xt={class:"stat-circle-value"},Zt={class:"water-stat-circle"},ea={class:"stat-circle-bg"},ta={class:"stat-circle-value"},aa={class:"water-stat-circle"},oa={class:"stat-circle-bg"},na={class:"stat-circle-value"},la={class:"water-stat-circle"},ra={class:"stat-circle-bg"},sa={class:"stat-circle-value"},ia={class:"water-stat-circle"},ca={class:"stat-circle-bg"},da={class:"stat-circle-value"},ua={key:0,class:"chart-selection-tip"},va={key:1,class:"chart-container"},ga={key:2,class:"chart-container"},ma={key:3,class:"chart-container"},ha={key:4,class:"chart-container"},fa={key:1,class:"water-comparison-panel"},pa={class:"panel-header"},wa={class:"header-actions"},ya={key:0,class:"chart-selection-tip"},Ca={key:1,class:"chart-container"},Da={key:2,class:"chart-container"},ba={key:3,class:"chart-container"},Sa={key:4,class:"chart-container"},xa={key:2,class:"environment-statistics-panel"},Na={class:"panel-header"},_a={class:"header-actions"},Ea={class:"environment-statistics-cards"},Ia={class:"environment-stat-circle"},La={class:"stat-circle-bg"},Ma={class:"stat-circle-value"},ka={class:"environment-stat-circle"},$a={class:"stat-circle-bg"},Ra={class:"stat-circle-value"},Aa={class:"environment-stat-circle"},Oa={class:"stat-circle-bg"},Ba={class:"stat-circle-value"},Va={class:"environment-stat-circle"},Pa={class:"stat-circle-bg"},Fa={class:"stat-circle-value"},za={class:"environment-stat-circle"},Wa={class:"stat-circle-bg"},Ya={class:"stat-circle-value"},Ua={class:"environment-stat-circle"},Ta={class:"stat-circle-bg"},Ha={class:"stat-circle-value"},ja={class:"environment-stat-circle"},Ga={class:"stat-circle-bg"},qa={class:"stat-circle-value"},Ja={key:0,class:"chart-selection-tip"},Ka={key:1,class:"chart-container ammonia-nitrogen-chart"},Qa={key:2,class:"chart-container permanganate-index-chart"},Xa={key:3,class:"chart-container cod-chart"},Za={key:4,class:"chart-container flow-chart"},eo={key:5,class:"chart-container depth-chart"},to={key:6,class:"chart-container total-nitrogen-chart"},ao={key:7,class:"chart-container total-phosphorus-chart"},oo={key:3,class:"environment-comparison-panel"},no={class:"panel-header"},lo={class:"header-actions"},ro={key:0,class:"chart-selection-tip"},so={key:1,class:"chart-container environment-ammonia-nitrogen-chart"},io={key:2,class:"chart-container environment-permanganate-index-chart"},co={key:3,class:"chart-container environment-cod-chart"},uo={key:4,class:"chart-container environment-flow-chart"},vo={key:5,class:"chart-container environment-depth-chart"},go={key:6,class:"chart-container environment-total-nitrogen-chart"},mo={key:7,class:"chart-container environment-total-phosphorus-chart"};function ho(F,a,ue,s,oe,k){const L=se("statistics-analysis-header"),D=se("el-option"),O=se("el-select"),B=se("el-date-picker"),H=se("el-button"),j=se("el-empty");return y(),C("div",Ft,[m(L,{title:"统计分析"}),o("div",zt,[o("div",Wt,[o("div",{class:be(["sidebar-box",{active:s.activeBox==="waterStatistics"}]),onClick:a[0]||(a[0]=w=>s.activeBox="waterStatistics")},"水情统计",2),o("div",{class:be(["sidebar-box",{active:s.activeBox==="waterComparison"}]),onClick:a[1]||(a[1]=w=>s.activeBox="waterComparison")},"水情对比",2),o("div",{class:be(["sidebar-box",{active:s.activeBox==="environmentStatistics"}]),onClick:a[2]||(a[2]=w=>s.activeBox="environmentStatistics")},"环境统计",2),o("div",{class:be(["sidebar-box",{active:s.activeBox==="environmentComparison"}]),onClick:a[3]||(a[3]=w=>s.activeBox="environmentComparison")},"环境对比",2)]),o("div",Yt,[s.activeBox==="waterStatistics"?(y(),C("div",Ut,[o("div",Tt,[a[17]||(a[17]=o("h2",null,"水情统计",-1)),o("div",Ht,[m(O,{modelValue:s.selectedReservoir,"onUpdate:modelValue":a[4]||(a[4]=w=>s.selectedReservoir=w),placeholder:"选择水库",style:{width:"200px","margin-right":"10px"}},{default:M(()=>[(y(!0),C(Se,null,xe(s.reservoirList,w=>(y(),Ne(D,{key:w,label:w,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),m(B,{modelValue:s.selectedDateRange,"onUpdate:modelValue":a[5]||(a[5]=w=>s.selectedDateRange=w),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD","disabled-date":s.disableUnavailableDates,style:{width:"280px","margin-right":"10px"}},null,8,["modelValue","disabled-date"]),m(O,{modelValue:s.selectedCharts,"onUpdate:modelValue":a[6]||(a[6]=w=>s.selectedCharts=w),multiple:"","collapse-tags":"",placeholder:"选择显示表格(至少1个)",style:{width:"280px","margin-right":"10px"}},{default:M(()=>[m(D,{label:"水位分布",value:"waterLevel"}),m(D,{label:"蓄水量变化",value:"waterStorage"}),m(D,{label:"日均入库流量变化",value:"waterInflow"}),m(D,{label:"日均出库流量变化",value:"waterOutflow"})]),_:1},8,["modelValue"]),m(H,{type:"primary",onClick:s.applySelectedWaterStats},{default:M(()=>a[16]||(a[16]=[_e("查询",-1)])),_:1,__:[16]},8,["onClick"])])]),o("div",jt,[o("div",Gt,[o("div",qt,[o("div",Jt,q((s.waterStats.avgWaterLevel||0).toFixed(2)),1)]),a[18]||(a[18]=o("div",{class:"stat-circle-label"},[o("div",null,"库水位"),o("div",{class:"unit-text"},"(米)")],-1))]),o("div",Kt,[o("div",Qt,[o("div",Xt,q((s.waterStats.totalStorage||0).toFixed(0)),1)]),a[19]||(a[19]=o("div",{class:"stat-circle-label"},[o("div",null,"蓄水量"),o("div",{class:"unit-text"},"(万立方米)")],-1))]),o("div",Zt,[o("div",ea,[o("div",ta,q((s.waterStats.avgInflow||0).toFixed(2)),1)]),a[20]||(a[20]=o("div",{class:"stat-circle-label"},[o("div",null,"日均入库流量"),o("div",{class:"unit-text"},"(立方米/秒)")],-1))]),o("div",aa,[o("div",oa,[o("div",na,q((s.waterStats.avgOutflow||0).toFixed(2)),1)]),a[21]||(a[21]=o("div",{class:"stat-circle-label"},[o("div",null,"日均出库流量"),o("div",{class:"unit-text"},"(立方米/秒)")],-1))]),o("div",la,[o("div",ra,[o("div",sa,q((s.waterStats.totalCapacity||0).toFixed(0)),1)]),a[22]||(a[22]=o("div",{class:"stat-circle-label"},[o("div",null,"总库容"),o("div",{class:"unit-text"},"(万立方米)")],-1))]),o("div",ia,[o("div",ca,[o("div",da,q((s.waterStats.floodLevel||0).toFixed(2)),1)]),a[23]||(a[23]=o("div",{class:"stat-circle-label"},[o("div",null,"汛限水位"),o("div",{class:"unit-text"},"(米)")],-1))])]),s.selectedCharts.length===0?(y(),C("div",ua,[m(j,{description:"请选择要显示的表格","image-size":120},{description:M(()=>a[24]||(a[24]=[o("div",{class:"tip-content"},[o("p",null,"请在上方选择要显示的表格类型"),o("p",null,"选择完成后，对应的图表将自动显示")],-1)])),_:1})])):N("",!0),s.selectedCharts.includes("waterLevel")?(y(),C("div",va,a[25]||(a[25]=[o("h3",null,"水位分布",-1),o("div",{id:"water-level-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedCharts.includes("waterStorage")?(y(),C("div",ga,a[26]||(a[26]=[o("h3",null,"蓄水量变化",-1),o("div",{id:"water-storage-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedCharts.includes("waterInflow")?(y(),C("div",ma,a[27]||(a[27]=[o("h3",null,"日均入库流量变化",-1),o("div",{id:"water-inflow-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedCharts.includes("waterOutflow")?(y(),C("div",ha,a[28]||(a[28]=[o("h3",null,"日均出库流量变化",-1),o("div",{id:"water-outflow-chart",class:"chart"},null,-1)]))):N("",!0)])):s.activeBox==="waterComparison"?(y(),C("div",fa,[o("div",pa,[a[30]||(a[30]=o("h2",null,"水情对比",-1)),o("div",wa,[m(O,{modelValue:s.selectedReservoirs,"onUpdate:modelValue":a[7]||(a[7]=w=>s.selectedReservoirs=w),multiple:"","collapse-tags":"",placeholder:"选择水库(至少2个)",style:{width:"320px","margin-right":"10px"}},{default:M(()=>[(y(!0),C(Se,null,xe(s.reservoirList,w=>(y(),Ne(D,{key:w,label:w,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),m(B,{modelValue:s.selectedComparisonDateRange,"onUpdate:modelValue":a[8]||(a[8]=w=>s.selectedComparisonDateRange=w),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD","disabled-date":s.disableUnavailableComparisonDates,style:{width:"240px","margin-right":"10px"}},null,8,["modelValue","disabled-date"]),m(O,{modelValue:s.selectedComparisonCharts,"onUpdate:modelValue":a[9]||(a[9]=w=>s.selectedComparisonCharts=w),multiple:"","collapse-tags":"",placeholder:"选择显示表格(至少1个)",style:{width:"240px","margin-right":"10px"}},{default:M(()=>[m(D,{label:"水位对比",value:"waterLevel"}),m(D,{label:"蓄水量对比",value:"storage"}),m(D,{label:"入库流量对比",value:"avgInflow"}),m(D,{label:"出库流量对比",value:"avgOutflow"})]),_:1},8,["modelValue"]),m(H,{type:"primary",onClick:s.refreshComparisonData},{default:M(()=>a[29]||(a[29]=[_e("刷新",-1)])),_:1,__:[29]},8,["onClick"])])]),s.selectedComparisonCharts.length===0?(y(),C("div",ya,[m(j,{description:"请选择要显示的对比表格","image-size":120},{description:M(()=>a[31]||(a[31]=[o("div",{class:"tip-content"},[o("p",null,"请在上方选择要显示的对比表格类型"),o("p",null,"选择完成后，对应的对比图表将自动显示")],-1)])),_:1})])):N("",!0),s.selectedComparisonCharts.includes("waterLevel")?(y(),C("div",Ca,a[32]||(a[32]=[o("h3",null,"水位对比",-1),o("div",{id:"water-level-comparison-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedComparisonCharts.includes("storage")?(y(),C("div",Da,a[33]||(a[33]=[o("h3",null,"蓄水量对比",-1),o("div",{id:"water-storage-comparison-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedComparisonCharts.includes("avgInflow")?(y(),C("div",ba,a[34]||(a[34]=[o("h3",null,"入库流量对比",-1),o("div",{id:"water-inflow-comparison-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedComparisonCharts.includes("avgOutflow")?(y(),C("div",Sa,a[35]||(a[35]=[o("h3",null,"出库流量对比",-1),o("div",{id:"water-outflow-comparison-chart",class:"chart"},null,-1)]))):N("",!0)])):s.activeBox==="environmentStatistics"?(y(),C("div",xa,[o("div",Na,[a[37]||(a[37]=o("h2",null,"环境统计",-1)),o("div",_a,[m(O,{modelValue:s.selectedMonitorPoint,"onUpdate:modelValue":a[10]||(a[10]=w=>s.selectedMonitorPoint=w),placeholder:"选择监测点",style:{width:"180px","margin-right":"10px"}},{default:M(()=>[(y(!0),C(Se,null,xe(s.monitorPointList,w=>(y(),Ne(D,{key:w,label:w,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),m(B,{modelValue:s.selectedEnvDateRange,"onUpdate:modelValue":a[11]||(a[11]=w=>s.selectedEnvDateRange=w),type:"monthrange","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份","value-format":"YYYY-MM","disabled-date":s.disableUnavailableEnvDates,style:{width:"240px","margin-right":"10px"}},null,8,["modelValue","disabled-date"]),m(O,{modelValue:s.selectedEnvironmentCharts,"onUpdate:modelValue":a[12]||(a[12]=w=>s.selectedEnvironmentCharts=w),multiple:"","collapse-tags":"",placeholder:"选择显示内容(至少1个)",style:{width:"240px","margin-right":"10px"}},{default:M(()=>[m(D,{label:"氨氮",value:"ammoniaNitrogen"}),m(D,{label:"高锰酸盐",value:"permanganateIndex"}),m(D,{label:"化学需氧量",value:"cod"}),m(D,{label:"流量",value:"flow"}),m(D,{label:"水深",value:"depth"}),m(D,{label:"总氮",value:"totalNitrogen"}),m(D,{label:"总磷",value:"totalPhosphorus"})]),_:1},8,["modelValue"]),m(H,{type:"primary",onClick:s.applySelectedEnvironmentStats},{default:M(()=>a[36]||(a[36]=[_e(" 查询 ",-1)])),_:1,__:[36]},8,["onClick"])])]),o("div",Ea,[o("div",Ia,[o("div",La,[o("div",Ma,q(s.formatNumber(s.envDisplayStats.ammoniaNitrogen,2)),1)]),a[38]||(a[38]=o("div",{class:"stat-circle-label"},[o("div",null,"氨氮"),o("div",{class:"unit-text"},"(mg/L)")],-1))]),o("div",ka,[o("div",$a,[o("div",Ra,q(s.formatNumber(s.envDisplayStats.permanganateIndex,2)),1)]),a[39]||(a[39]=o("div",{class:"stat-circle-label"},[o("div",null,"高锰酸盐"),o("div",{class:"unit-text"},"(mg/L)")],-1))]),o("div",Aa,[o("div",Oa,[o("div",Ba,q(s.formatNumber(s.envDisplayStats.cod,2)),1)]),a[40]||(a[40]=o("div",{class:"stat-circle-label"},[o("div",null,"化学需氧量"),o("div",{class:"unit-text"},"(mg/L)")],-1))]),o("div",Va,[o("div",Pa,[o("div",Fa,q(s.formatNumber(s.envDisplayStats.flow,2)),1)]),a[41]||(a[41]=o("div",{class:"stat-circle-label"},[o("div",null,"流量"),o("div",{class:"unit-text"},"(m³/s)")],-1))]),o("div",za,[o("div",Wa,[o("div",Ya,q(s.formatNumber(s.envDisplayStats.depth,2)),1)]),a[42]||(a[42]=o("div",{class:"stat-circle-label"},[o("div",null,"水深"),o("div",{class:"unit-text"},"(m)")],-1))]),o("div",Ua,[o("div",Ta,[o("div",Ha,q(s.formatNumber(s.envDisplayStats.totalNitrogen,2)),1)]),a[43]||(a[43]=o("div",{class:"stat-circle-label"},[o("div",null,"总氮"),o("div",{class:"unit-text"},"(mg/L)")],-1))]),o("div",ja,[o("div",Ga,[o("div",qa,q(s.formatNumber(s.envDisplayStats.totalPhosphorus,2)),1)]),a[44]||(a[44]=o("div",{class:"stat-circle-label"},[o("div",null,"总磷"),o("div",{class:"unit-text"},"(mg/L)")],-1))])]),s.selectedEnvironmentCharts.length===0?(y(),C("div",Ja,[m(j,{description:"请选择要显示的指标","image-size":120},{description:M(()=>a[45]||(a[45]=[o("div",{class:"tip-content"},[o("p",null,"请在上方选择要显示的指标类型"),o("p",null,"选择完成后，对应的指标图表将自动显示")],-1)])),_:1})])):N("",!0),s.selectedEnvironmentCharts.includes("ammoniaNitrogen")?(y(),C("div",Ka,a[46]||(a[46]=[o("h3",null,"氨氮指标分布",-1),o("div",{id:"ammonia-nitrogen-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentCharts.includes("permanganateIndex")?(y(),C("div",Qa,a[47]||(a[47]=[o("h3",null,"高锰酸盐指标分布",-1),o("div",{id:"permanganate-index-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentCharts.includes("cod")?(y(),C("div",Xa,a[48]||(a[48]=[o("h3",null,"化学需氧量指标分布",-1),o("div",{id:"cod-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentCharts.includes("flow")?(y(),C("div",Za,a[49]||(a[49]=[o("h3",null,"流量指标分布",-1),o("div",{id:"flow-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentCharts.includes("depth")?(y(),C("div",eo,a[50]||(a[50]=[o("h3",null,"水深指标分布",-1),o("div",{id:"depth-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentCharts.includes("totalNitrogen")?(y(),C("div",to,a[51]||(a[51]=[o("h3",null,"总氮指标分布",-1),o("div",{id:"total-nitrogen-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentCharts.includes("totalPhosphorus")?(y(),C("div",ao,a[52]||(a[52]=[o("h3",null,"总磷指标分布",-1),o("div",{id:"total-phosphorus-chart",class:"chart"},null,-1)]))):N("",!0)])):s.activeBox==="environmentComparison"?(y(),C("div",oo,[o("div",no,[a[54]||(a[54]=o("h2",null,"环境对比",-1)),o("div",lo,[m(O,{modelValue:s.selectedMonitorPoints,"onUpdate:modelValue":a[13]||(a[13]=w=>s.selectedMonitorPoints=w),multiple:"","collapse-tags":"",placeholder:"选择监测点(至少2个)",style:{width:"240px","margin-right":"10px"}},{default:M(()=>[(y(!0),C(Se,null,xe(s.monitorPointList,w=>(y(),Ne(D,{key:w,value:w},null,8,["value"]))),128))]),_:1},8,["modelValue"]),m(B,{modelValue:s.selectedEnvComparisonDateRange,"onUpdate:modelValue":a[14]||(a[14]=w=>s.selectedEnvComparisonDateRange=w),type:"monthrange","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份","value-format":"YYYY-MM","disabled-date":s.disableUnavailableEnvComparisonDates,style:{width:"240px","margin-right":"10px"}},null,8,["modelValue","disabled-date"]),m(O,{modelValue:s.selectedEnvironmentComparisonCharts,"onUpdate:modelValue":a[15]||(a[15]=w=>s.selectedEnvironmentComparisonCharts=w),multiple:"","collapse-tags":"",placeholder:"选择显示指标(至少1个)",style:{width:"280px","margin-right":"10px"}},{default:M(()=>[m(D,{label:"氨氮",value:"ammoniaNitrogen"}),m(D,{label:"高锰酸盐",value:"permanganateIndex"}),m(D,{label:"化学需氧量",value:"cod"}),m(D,{label:"流量",value:"flow"}),m(D,{label:"水深",value:"depth"}),m(D,{label:"总氮",value:"totalNitrogen"}),m(D,{label:"总磷",value:"totalPhosphorus"})]),_:1},8,["modelValue"]),m(H,{type:"primary",onClick:s.refreshEnvironmentComparison},{default:M(()=>a[53]||(a[53]=[_e(" 刷新 ",-1)])),_:1,__:[53]},8,["onClick"])])]),s.selectedEnvironmentComparisonCharts.length===0?(y(),C("div",ro,[m(j,{description:"请选择要显示的对比指标","image-size":120},{description:M(()=>a[55]||(a[55]=[o("div",{class:"tip-content"},[o("p",null,"请在上方选择要显示的对比指标类型"),o("p",null,"选择完成后，对应的对比图表将自动显示")],-1)])),_:1})])):N("",!0),s.selectedEnvironmentComparisonCharts.includes("ammoniaNitrogen")?(y(),C("div",so,a[56]||(a[56]=[o("h3",null,"氨氮指标对比分析",-1),o("div",{id:"environment-ammonia-nitrogen-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentComparisonCharts.includes("permanganateIndex")?(y(),C("div",io,a[57]||(a[57]=[o("h3",null,"高锰酸盐指标对比分析",-1),o("div",{id:"environment-permanganate-index-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentComparisonCharts.includes("cod")?(y(),C("div",co,a[58]||(a[58]=[o("h3",null,"化学需氧量指标对比分析",-1),o("div",{id:"environment-cod-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentComparisonCharts.includes("flow")?(y(),C("div",uo,a[59]||(a[59]=[o("h3",null,"流量指标对比分析",-1),o("div",{id:"environment-flow-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentComparisonCharts.includes("depth")?(y(),C("div",vo,a[60]||(a[60]=[o("h3",null,"水深指标对比分析",-1),o("div",{id:"environment-depth-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentComparisonCharts.includes("totalNitrogen")?(y(),C("div",go,a[61]||(a[61]=[o("h3",null,"总氮指标对比分析",-1),o("div",{id:"environment-total-nitrogen-chart",class:"chart"},null,-1)]))):N("",!0),s.selectedEnvironmentComparisonCharts.includes("totalPhosphorus")?(y(),C("div",mo,a[62]||(a[62]=[o("h3",null,"总磷指标对比分析",-1),o("div",{id:"environment-total-phosphorus-chart",class:"chart"},null,-1)]))):N("",!0)])):N("",!0)])])])}const Co=Te(Pt,[["render",ho],["__scopeId","data-v-ace25d9d"]]);export{Co as default};
