# 湖泊河流扩散模拟模型说明

## 项目概述

本项目实现了湖泊和河流两种水体的污染物扩散模拟系统，分别采用二维和一维扩散模型，基于对流-扩散方程进行数值求解，支持实时动画展示污染物在水体中的扩散过程。

## 数学模型

### 1. 湖泊二维扩散模型

#### 控制方程
湖泊采用二维对流-扩散方程：

```
∂C/∂t + u·∇C = D∇²C - K₁C
```

其中：
- `C(x,y,t)`：污染物浓度 (mg/L)
- `u = (vx, vy)`：流速向量 (m/s)
- `D`：弥散系数张量 (m²/s)
- `K₁`：一级降解系数 (1/s)
- `t`：时间 (s)
- `(x,y)`：二维空间坐标 (m)

#### 解析解
对于瞬时点源，二维扩散方程的解析解为：

```
C(x,y,t) = (m/(2πH√(ExEy))) × (1/t√t) × exp(-K₁t) × exp(-((x-vx·t)²/(4Ex·t) + (y-vy·t)²/(4Ey·t)))
```

其中：
- `m`：污染物质量 (g)
- `H`：水深 (m)
- `Ex`：纵向弥散系数 (m²/s)
- `Ey`：横向弥散系数 (m²/s)

### 2. 河流一维扩散模型

#### 控制方程
河流采用一维对流-扩散方程：

```
∂C/∂t + u·∂C/∂x = D·∂²C/∂x² - K₁C
```

其中：
- `C(x,t)`：污染物浓度 (mg/L)
- `u`：河流流速 (m/s)
- `D`：纵向弥散系数 (m²/s)
- `K₁`：一级降解系数 (1/s)
- `t`：时间 (s)
- `x`：沿河流方向的距离 (m)

#### 解析解
对于瞬时点源，一维扩散方程的解析解为：

```
C(x,t) = (m/(HW√(4πEx))) × (1/√t) × exp(-K₁t) × exp(-(x-ut)²/(4Ex·t))
```

其中：
- `m`：污染物质量 (g)
- `H`：水深 (m)
- `W`：河宽 (m)
- `Ex`：纵向弥散系数 (m²/s)

## 模型输入参数

### 1. 湖泊模型输入

#### 污染物参数
- **污染物类型**：硝基苯、苯酚、氨氮、石油类
- **污染物质量** (kg)：0.1 - 10000
- **衰减系数** (d⁻¹)：0 - 10

#### 湖泊参数
- **平均深度** (m)：1 - 100
- **纵向流速** (m/s)：0 - 5
- **横向流速** (m/s)：0 - 5
- **纵向弥散系数** (m²/s)：0.1 - 100
- **横向弥散系数** (m²/s)：0.1 - 100

#### 模拟参数
- **网格间距** (m)：5 - 100
- **模拟时长** (小时)：0.5 - 24
- **时间步长** (分钟)：1 - 60

### 2. 河流模型输入

#### 污染物参数
- **污染物类型**：有机污染物、无机污染物、重金属、营养盐、农药
- **污染物质量** (kg)：1 - 1000
- **衰减系数** (d⁻¹)：0.001 - 1.0

#### 河流参数
- **河宽** (m)：10 - 200
- **水深** (m)：1 - 20
- **流速** (m/s)：0.1 - 5.0
- **纵向弥散系数** (m²/s)：1 - 100

#### 模拟参数
- **网格间距** (m)：10 - 100
- **模拟时长** (小时)：1 - 24
- **时间步长** (分钟)：5 - 60

## 模型输出结果

### 1. 空间分布
- **浓度场**：每个网格点的污染物浓度值
- **扩散范围**：污染物影响的空间范围
- **浓度梯度**：浓度随距离的变化规律

### 2. 时间演化
- **时间序列**：不同时刻的浓度分布
- **扩散速度**：污染物扩散的时间特征
- **衰减过程**：污染物浓度的衰减规律

### 3. 可视化输出
- **颜色映射**：浓度值的颜色表示
  - 蓝色：无污染或极低浓度
  - 绿色：低浓度
  - 黄色：中浓度
  - 橙色：中高浓度
  - 红色：高浓度
  - 紫色：极高浓度
- **动画展示**：时间序列的动态显示
- **统计信息**：最大浓度、影响范围等

## 扩散过程说明

### 1. 湖泊扩散特征

#### 物理机制
1. **对流扩散**：污染物随水流运动
2. **分子扩散**：浓度梯度驱动的扩散
3. **湍流扩散**：水体湍流引起的混合
4. **化学衰减**：污染物自身的降解

#### 扩散模式
- **全方向扩散**：污染物向四周扩散
- **边界限制**：扩散严格限制在湖泊边界内
- **浓度梯度**：从污染源向四周递减
- **时间演化**：浓度峰值随时间向下游移动

### 2. 河流扩散特征

#### 物理机制
1. **对流传输**：污染物随河流流向运动
2. **纵向扩散**：沿河流方向的扩散
3. **横向混合**：河流横断面上的混合
4. **化学衰减**：污染物降解过程

#### 扩散模式
- **单向扩散**：只向下游方向扩散
- **对流主导**：流速远大于扩散速度
- **浓度峰值**：随水流向下游移动
- **纵向拉伸**：浓度分布沿河流方向拉伸

## 湖泊与河流模型区别

### 1. 数学模型差异

| 特征 | 湖泊模型 | 河流模型 |
|------|----------|----------|
| **维度** | 二维扩散 | 一维扩散 |
| **控制方程** | ∂C/∂t + u·∇C = D∇²C - K₁C | ∂C/∂t + u·∂C/∂x = D·∂²C/∂x² - K₁C |
| **空间变量** | (x, y) 二维坐标 | x 一维坐标 |
| **扩散方向** | 全方向扩散 | 单向扩散（下游） |
| **边界条件** | 湖泊边界限制 | 河流流向限制 |

### 2. 网格系统差异

| 特征 | 湖泊网格 | 河流网格 |
|------|----------|----------|
| **网格类型** | 二维规则网格 | 一维沿河流网格 |
| **网格生成** | 多边形内点检测 | 沿河流线插值 |
| **网格密度** | 根据湖泊面积调整 | 根据河流长度调整 |
| **边界处理** | 射线法边界检测 | 距离阈值检测 |

### 3. 计算复杂度

| 特征 | 湖泊计算 | 河流计算 |
|------|----------|----------|
| **计算量** | O(n²×t) | O(n×t) |
| **内存需求** | 较高（二维数组） | 较低（一维数组） |
| **计算时间** | 较长 | 较短 |
| **优化策略** | 距离筛选、计算间隔 | 下游限制、坐标采样 |

### 4. 物理特征差异

| 特征 | 湖泊水体 | 河流水体 |
|------|----------|----------|
| **流动特征** | 环流、涡流 | 单向流动 |
| **扩散机制** | 各向异性扩散 | 对流主导扩散 |
| **时间尺度** | 较长（小时-天） | 较短（分钟-小时） |
| **空间尺度** | 较大（平方公里） | 较小（线性分布） |

### 5. 应用场景差异

| 应用场景 | 湖泊模型适用 | 河流模型适用 |
|----------|--------------|--------------|
| **水库污染** | ✓ | ✗ |
| **湖泊富营养化** | ✓ | ✗ |
| **河流突发污染** | ✗ | ✓ |
| **河流连续排放** | ✗ | ✓ |
| **河口扩散** | ✓ | ✓ |
| **近岸扩散** | ✓ | ✗ |

## 模型验证与精度

### 1. 数值稳定性
- **时间步长限制**：确保数值稳定性
- **空间分辨率**：平衡精度与计算效率
- **边界条件**：正确处理物理边界

### 2. 物理合理性
- **质量守恒**：污染物总量随时间衰减
- **浓度非负**：浓度值始终为非负数
- **扩散对称性**：扩散过程符合物理规律

### 3. 模型局限性
- **简化假设**：忽略复杂的水文地质条件
- **参数不确定性**：模型参数存在不确定性
- **边界效应**：边界条件可能影响结果

## 性能优化策略

### 1. 计算优化
- **距离筛选**：远距离点直接设为0
- **计算间隔**：减少时间步计算量
- **异步处理**：避免UI阻塞
- **数值稳定性检查**：防止计算溢出

### 2. 显示优化
- **阈值过滤**：只显示有效浓度点
- **颜色映射**：优化视觉效果
- **图层管理**：高效管理地图图层
- **动画控制**：流畅的时间序列播放

### 3. 内存管理
- **网格优化**：根据水体特征调整网格密度
- **数据压缩**：减少存储需求
- **垃圾回收**：及时清理不需要的数据

## 扩展功能建议

### 1. 模型增强
- **三维模型**：扩展到三维扩散模拟
- **多污染源**：支持多个污染源同时模拟
- **复杂边界**：支持更复杂的水体边界
- **实时数据**：接入实时监测数据

### 2. 功能扩展
- **预测分析**：基于历史数据的预测功能
- **风险评估**：污染物扩散风险评估
- **应急响应**：突发污染事件应急模拟
- **报告生成**：自动生成模拟报告

### 3. 技术改进
- **GPU加速**：利用GPU进行并行计算
- **机器学习**：结合机器学习优化参数
- **云平台**：支持云端计算和存储
- **移动端**：开发移动端应用

## 使用建议

### 1. 参数设置
- **网格间距**：根据水体大小和精度要求设置
- **时间步长**：确保数值稳定性
- **模拟时长**：根据污染物特性确定
- **衰减系数**：参考污染物化学特性

### 2. 结果解释
- **浓度单位**：注意浓度单位的一致性
- **时间尺度**：理解时间序列的物理意义
- **空间范围**：关注污染物影响范围
- **不确定性**：考虑模型参数的不确定性

### 3. 应用场景
- **环境影响评价**：评估污染物对环境的影响
- **应急响应**：突发污染事件的快速评估
- **规划决策**：为环境规划提供科学依据
- **科学研究**：支持水环境科学研究

---

*本文档详细说明了湖泊和河流扩散模拟的数学模型、实现方法和应用特点，为系统使用和进一步开发提供技术参考。* 